# Security Headers
<IfModule mod_headers.c>
    # Prevent clickjacking attacks
    Header set X-Frame-Options "SAMEORIGIN"

    # Prevent MIME type sniffing
    Header set X-Content-Type-Options "nosniff"

    # Enable XSS protection
    Header set X-XSS-Protection "1; mode=block"

    # Referrer policy
    Header set Referrer-Policy "strict-origin-when-cross-origin"

    # Content Security Policy (adjust as needed for your site)
    Header set Content-Security-Policy "default-src 'self' https:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https:; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; font-src 'self' data: https:; connect-src 'self' https:; frame-ancestors 'self';"

    # Permissions Policy (formerly Feature Policy)
    Header set Permissions-Policy "camera=(), microphone=(), geolocation=()"
</IfModule>

# Protect wp-config.php
<Files wp-config.php>
    Order allow,deny
    Deny from all
</Files>

# Disable directory browsing
Options -Indexes

# Block access to xmlrpc.php (prevents brute force attacks)
<Files xmlrpc.php>
    Order allow,deny
    Deny from all
</Files>

# Protect .htaccess and .htpasswd files
<FilesMatch "^\.ht">
    Order allow,deny
    Deny from all
</FilesMatch>

# Disable PHP execution in uploads directory
# NOTE: Update this path to match your GoDaddy hosting path structure
# Common GoDaddy paths: /home/USERNAME/public_html/wp-content/uploads
# You can also use relative path: wp-content/uploads (remove Directory tags and use FilesMatch only)
<Directory "wp-content/uploads">
    <FilesMatch "\.php$">
        Order allow,deny
        Deny from all
    </FilesMatch>
</Directory>

# BEGIN WordPress
# The directives (lines) between "BEGIN WordPress" and "END WordPress" are
# dynamically generated, and should only be modified via WordPress filters.
# Any changes to the directives between these markers will be overwritten.
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress
